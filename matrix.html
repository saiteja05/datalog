<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decision Matrix</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
    
    <style>
        /* --- CORE STYLES --- */
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; overflow: hidden; background-color: #f8f9fa; }

        /* --- HEADER --- */
        header { position: absolute; top: 0; left: 0; width: 100%; height: 60px; background-color: #001E2B; color: white; display: flex; align-items: center; padding: 0 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 100; }
        h1 { margin: 0; font-size: 1.4rem; font-weight: 600; }
        .subtitle { margin-left: 15px; font-size: 0.9rem; color: #4DB33D; border-left: 1px solid #555; padding-left: 15px; }

        /* --- DIAGRAM CONTAINER --- */
        #diagram-container { position: absolute; top: 60px; left: 0; right: 0; bottom: 0; background-image: radial-gradient(#e0e0e0 1px, transparent 1px); background-size: 20px 20px; overflow: hidden; transition: margin-right 0.3s ease; }
        .mermaid { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
        .mermaid svg { height: 100% !important; width: 100% !important; max-width: none !important; }

        /* --- CONTROLS --- */
        .controls { position: absolute; bottom: 30px; left: 30px; background: white; padding: 8px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); display: flex; flex-direction: column; gap: 8px; z-index: 90; }
        button.ctrl-btn { width: 44px; height: 44px; border: 1px solid #e0e0e0; background: white; border-radius: 8px; cursor: pointer; font-size: 1.4rem; color: #444; transition: all 0.2s ease; }
        button.ctrl-btn:hover { background-color: #f5f5f5; color: #4DB33D; border-color: #4DB33D; }

        /* --- LEGEND --- */
        .legend { position: absolute; top: 80px; left: 20px; background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid #f0f0f0; font-size: 0.85rem; z-index: 90; }
        .legend-item { display: flex; align-items: center; margin-bottom: 8px; color: #444; font-weight: 500; }
        .dot { width: 14px; height: 14px; border-radius: 4px; margin-right: 12px; }
        .l-value { background-color: #4DB33D; border: 2px solid #3FA037; }
        .l-tech { background-color: #E3F2FD; border: 1px solid #1565C0; }

        /* --- SIDE DRAWER (The Elegant Popup) --- */
        #side-drawer {
            position: fixed;
            top: 60px; /* Below header */
            right: -450px; /* Hidden by default */
            width: 400px;
            bottom: 0;
            background: white;
            box-shadow: -5px 0 30px rgba(0,0,0,0.1);
            z-index: 200;
            transition: right 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            display: flex;
            flex-direction: column;
            border-left: 1px solid #eee;
        }

        #side-drawer.open { right: 0; }

        .drawer-header {
            background: #fff;
            padding: 25px 30px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .drawer-header h2 { margin: 0; font-size: 1.3rem; color: #001e2b; font-weight: 700; }
        .close-btn { background: none; border: none; font-size: 1.8rem; color: #999; cursor: pointer; padding: 0; line-height: 1; }
        .close-btn:hover { color: #333; }

        .drawer-body { padding: 30px; overflow-y: auto; flex-grow: 1; }

        .value-prop-box {
            background: #E8F5E9;
            border-left: 4px solid #4DB33D;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 0 8px 8px 0;
        }
        .value-label { font-size: 0.75rem; text-transform: uppercase; color: #3FA037; font-weight: bold; display: block; margin-bottom: 8px; letter-spacing: 0.5px; }
        .value-text { font-size: 1.1rem; color: #111; font-weight: 600; line-height: 1.4; }

        .details-text { color: #444; line-height: 1.7; font-size: 0.95rem; margin-bottom: 30px; }

        .doc-link {
            display: block;
            text-align: center;
            background: #001E2B;
            color: white;
            padding: 12px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            transition: all 0.2s;
        }
        .doc-link:hover { background: #4DB33D; color: #001E2B; transform: translateY(-1px); }
        .no-link { background: #eee; color: #999; pointer-events: none; }

    </style>
</head>
<body>

    <header>
        <h1>Decision Matrix</h1>
        <span class="subtitle">for MongoDB v8.0</span>
    </header>

    <div class="legend">
        <strong>Zone Key</strong><br><br>
        <div class="legend-item"><div class="dot l-value"></div><strong>Click Green Nodes for Details</strong></div>
        <div class="legend-item"><div class="dot l-tech"></div>Data & Workload</div>
        <div class="legend-item" style="font-size: 0.8em; color: #888; margin-top:10px;">(Pan/Zoom Enabled)</div>
    </div>

    <div class="controls">
        <button class="ctrl-btn" onclick="zoomIn()">+</button>
        <button class="ctrl-btn" onclick="zoomOut()">-</button>
        <button class="ctrl-btn" onclick="resetZoom()">↺</button>
    </div>

    <div id="side-drawer">
        <div class="drawer-header">
            <h2 id="drawer-title">Node Title</h2>
            <button class="close-btn" onclick="closeDrawer()">×</button>
        </div>
        <div class="drawer-body">
            <div class="value-prop-box">
                <span class="value-label">Value Proposition</span>
                <span id="drawer-value" class="value-text">...</span>
            </div>
            <p id="drawer-details" class="details-text">...</p>
            <a id="drawer-link" href="#" target="_blank" class="doc-link">Read Documentation →</a>
        </div>
    </div>

    <div id="diagram-container" onclick="closeDrawer()">
        <div class="mermaid">
%%{init: {'theme': 'base', 'flowchart': {'curve': 'basis'}, 'themeVariables': { 'fontFamily': 'Segoe UI', 'fontSize': '16px', 'lineColor': '#555' }}}%%
flowchart TB
    %% --- ZONE 0: STRATEGIC VISION ---
    Start(["Start: Strategic Vision"]) --> BizModel{"**Business Model**<br>Internal Enterprise App<br>or B2B SaaS?"}
    
    BizModel -- "Internal App" --> WorkloadCheck
    BizModel -- "B2B SaaS" --> Tenancy{"**Multi-Tenancy Nuance**<br>Isolation Strategy?"}
    
    Tenancy -- "Silo (1 DB per Tenant)" --> Silo["**Management Nightmare**<br>High TCO"]
    Tenancy -- "Pool (Shared DB)" --> Isolation{"**Isolation Check**<br>Need strict data residency<br>per tenant?"}
    
    Isolation -- "Logical Isolation" --> Logical["**Logical Sharding**<br>Standard Collections"]
    Isolation -- "Physical Isolation" --> TenantShard["**Tenant-Aware Sharding**<br>Dedicate Nodes to VIPs"]
    
    Logical --> WorkloadCheck
    TenantShard --> WorkloadCheck

    %% --- ZONE 1: WORKLOAD & DATA ---
    WorkloadCheck{"**Workload Nature**<br>Transactional or<br>Analytical?"}
    WorkloadCheck -- Analytical (OLAP) --> AnalyticCheck{"**Analytical Nuance**<br>Massive Joins (10+),<br>Full Table Scans, OR<br>Deep History (&gt;500TB active)?"}
    AnalyticCheck -- Yes (Data Warehouse) --> DWH["**Data Warehouse**<br>Snowflake / Databricks<br>(Cost Efficiency for Cold Data)"]
    AnalyticCheck -- "No (Real-Time Analytics)" --> DevSkill{"**Team Skillset**<br>Code-First (Devs)<br>or SQL-First (DBAs)?"}
    WorkloadCheck -- Transactional (OLTP) --> DevSkill
    
    DevSkill -- "SQL-First" --> AcidCheck{"**ACID Nuance**<br>Multi-table transactions<br>across 10+ tables?"}
    DevSkill -- "Code-First" --> ObjMatch["**Value: Dev Experience**<br>No ORM / Impedance Mismatch"]
    ObjMatch --> DataNature{"**Data Nature**<br>Is the schema volatile<br>or hierarchical?"}
    
    AcidCheck -- Yes --> RigidSQL{"**Modernization Check**<br>Is innovation stifled<br>by schema changes?"}
    RigidSQL -- No --> RDBMS["**RDBMS**<br>SQL / Oracle"]
    RigidSQL -- Yes --> Migrator["**Relational Migrator**<br>Schema Transformation"]
    Migrator --> MongoCore["**MongoDB Core**<br>Flexible Schema"]
    
    AcidCheck -- No --> VolCheck{"**Volume Nuance**<br>Writes &gt; 5k/sec?"}
    VolCheck -- No --> RDBMS
    VolCheck -- Yes --> MongoCore
    
    DataNature -- Yes (JSON) --> GraphCheck{"**Graph Nuance**<br>Unbounded depth<br>(&gt; 3 hops)?"}
    GraphCheck -- Yes --> GraphDB["**Neo4j / Neptune**"]
    GraphCheck -- No --> KVCheck{"**Key-Value Nuance**<br>Simple ID Lookup?"}
    DataNature -- No (Rigid) --> AcidCheck
    
    KVCheck -- Yes --> Latency{"**Latency Nuance**<br>Need &lt;1ms response<br>&amp; OK with data loss?"}
    Latency -- Yes --> Redis["**Redis / Memcached**"]
    Latency -- No --> MongoCore
    KVCheck -- No (Complex) --> QueryCheck{"**Query Nuance**<br>Need robust filtering,<br>secondary indexes,<br>or aggregations?"}
    QueryCheck -- Yes --> MongoCore
    
    MongoCore --> Agility{"**Velocity Check**<br>Does schema change<br>frequently?"}
    Agility -- Yes --> AgileVal["**Value: High Agility**<br>Faster Time-to-Market"]
    Agility -- No --> ScaleCheck{"**Scale Check**<br>Data &gt; 2TB OR<br>Writes &gt; 50k/s?"}
    AgileVal --> ScaleCheck

    %% --- ZONE 2: SCALE ---
    ScaleCheck -- Yes --> ShardStrat{"**Sharding Strategy**<br>Access Pattern?"}
    ShardStrat -- Distributed Writes --> HashShard["**Hashed Sharding**<br>Uniform Distribution"]
    ShardStrat -- Location Based --> ZoneShard["**Zone Sharding**<br>Data Locality"]
    ShardStrat -- Range Queries --> RangeShard["**Ranged Sharding**<br>Time/Alpha Grouping"]
    ScaleCheck -- No --> Replica["**Replica Set**<br>High Availability"]

    %% --- ZONE 3: PLATFORM & STREAMING ---
    HashShard --> PlatCheck{"**Workload Nuance**<br>Need Search, AI,<br>Streams, or Time Series?"}
    ZoneShard --> PlatCheck
    RangeShard --> PlatCheck
    Replica --> PlatCheck
    
    PlatCheck -- Just CRUD --> Integration{"**Ecosystem Check**<br>Need mature connectors<br>(Kafka/Spark)?"}
    
    %% Streaming Logic
    PlatCheck -- "Real-Time Streams" --> StreamCheck{"**Streaming Nuance**<br>Process data in-flight?"}
    StreamCheck -- "Yes (Kafka+Flink)" --> Flink["**Manage Separate Infra**<br>Complex Glue Code"]
    StreamCheck -- "Yes (Unified)" --> ASP["**Atlas Stream Processing**<br>Continuous Intelligence"]
    
    PlatCheck -- Search --> SearchDec{"**ETL Tolerance**<br>Want to manage<br>sync pipelines?"}
    SearchDec -- Yes --> Elastic["**Elasticsearch/SOLR**"]
    SearchDec -- No --> AtlasSearch["**Atlas Search**<br>Lucene on Node"]
    
    PlatCheck -- AI/Vector --> AIUse{"**AI Pattern**<br>How is Vector used?"}
    AIUse -- Chat History --> AgentMem["**Agent Memory**<br>Long-Term Context"]
    AIUse -- Reduce LLM Cost --> SemCache["**Semantic Cache**<br>Prevent Re-runs"]
    AIUse -- Knowledge Base --> RAG["**Knowledge Graph**<br>RAG + Filters"]
    
    PlatCheck -- IoT --> TimeSeries["**Time Series**<br>Columnar Store"]
    
    AtlasSearch --> Consolidation["**Value: Consolidation**<br>Reduced Tech Debt"]
    AgentMem --> Consolidation
    SemCache --> Consolidation
    RAG --> Consolidation
    TimeSeries --> Consolidation
    ASP --> Consolidation
    
    Consolidation --> Integration
    Integration -- No (Isolated) --> DeployCheck{"**Deployment**<br>Can data touch<br>public cloud?"}
    Integration -- Yes --> Connectors["**Value: Ecosystem**<br>Official Drivers/Connectors"]
    Connectors --> DeployCheck

    %% --- ZONE 4: DEPLOYMENT ---
    DeployCheck -- "No (Air-gapped)" --> SelfMan{"**Self-Managed**<br>Infrastructure?"}
    SelfMan -- Containers --> K8s["**Enterprise Operator**<br>OpenShift/K8s"]
    SelfMan -- VM/Metal --> OpsMan["**Ops Manager**<br>Automation"]
    
    K8s --> Secure{"**Trust Level**<br>Need 'Eyes-Off'?"}
    OpsMan --> Secure
    
    DeployCheck -- Yes (Cloud) --> Portability{"**Lock-In Check**<br>Need Cloud Agnostic<br>or Exit Strategy?"}
    Portability -- No (Specific Native) --> Dynamo["**DynamoDB/Firestore**<br>Single Cloud Lock-in"]
    Portability -- Yes (Portable) --> NetCheck{"**Network Security**<br>Connection Method?"}
    NetCheck -- AWS/Azure Backbone --> PrivLink["**PrivateLink**<br>One-way Security"]
    NetCheck -- VPC Peering --> Peering["**VPC Peering**<br>Bi-directional"]
    NetCheck -- Public Internet --> IPList["**IP Whitelist**<br>Standard TLS"]
    
    PrivLink --> RTOCheck{"**DR Strategy**<br>RTO/RPO Requirements?"}
    Peering --> RTOCheck
    IPList --> RTOCheck
    
    RTOCheck -- "Near-Zero RPO<br>(Multi-Cloud Resilience)" --> MultiCloud["**Multi-Cloud Cluster**<br>AWS+Azure+GCP"]
    RTOCheck -- Minutes (Standard)<br>(Single Region) --> Standard["**Standard Cluster**<br>3-Node Replica"]
    
    %% --- ZONE 5: LIFECYCLE & OPS ---
    Standard --> Lifecycle{"**Cost Efficiency**<br>Retain history &gt; 90 days?"}
    MultiCloud --> Lifecycle
    
    Lifecycle -- Yes --> Archive["**Online Archive**<br>Auto-Tiering to S3"]
    Lifecycle -- No --> ObsCheck
    Archive --> ObsCheck{"**Ops Nuance**<br>Need Automated<br>Performance Tuning?"}
    
    ObsCheck -- "No (Manual)" --> ManualOps["**Manual Tuning**<br>Query Analysis"]
    ObsCheck -- "Yes (Intelligent)" --> PerfAdv["**Performance Advisor**<br>Auto-Index Suggest"]
    
    PerfAdv --> Secure
    ManualOps --> Secure
    
    Secure -- Yes (Regulated) --> CSFLE["**Queryable Encryption**<br>Client-Side Keys<br>Encryption-in-Use"]
    Secure -- No --> Final(["**Final Architecture**"])
    CSFLE --> Final

    %% --- CLICK BINDINGS ---
    click ObjMatch showInfo
    click AgileVal showInfo
    click Consolidation showInfo
    click Logical showInfo
    click TenantShard showInfo
    click Migrator showInfo
    click MongoCore showInfo
    click HashShard showInfo
    click ZoneShard showInfo
    click RangeShard showInfo
    click Replica showInfo
    click ASP showInfo
    click AtlasSearch showInfo
    click Vector showInfo
    click AgentMem showInfo
    click SemCache showInfo
    click RAG showInfo
    click TimeSeries showInfo
    click Connectors showInfo
    click K8s showInfo
    click OpsMan showInfo
    click PrivLink showInfo
    click Peering showInfo
    click IPList showInfo
    click MultiCloud showInfo
    click Standard showInfo
    click Archive showInfo
    click PerfAdv showInfo
    click CSFLE showInfo

    %% --- STYLING ---
     Start:::startNode
     BizModel:::techZone
     Tenancy:::techZone
     Silo:::exitNode
     Isolation:::techZone
     Logical:::valueNode
     TenantShard:::valueNode
     WorkloadCheck:::techZone
     AnalyticCheck:::techZone
     DWH:::exitNode
     DevSkill:::techZone
     AcidCheck:::techZone
     ObjMatch:::valueNode
     DataNature:::techZone
     RigidSQL:::techZone
     RDBMS:::exitNode
     Migrator:::valueNode
     MongoCore:::valueNode
     VolCheck:::techZone
     GraphCheck:::techZone
     GraphDB:::exitNode
     KVCheck:::techZone
     Latency:::techZone
     Redis:::exitNode
     QueryCheck:::techZone
     Agility:::techZone
     AgileVal:::valueNode
     ScaleCheck:::scaleZone
     ShardStrat:::scaleZone
     HashShard:::valueNode
     ZoneShard:::valueNode
     RangeShard:::valueNode
     Replica:::valueNode
     PlatCheck:::platZone
     Integration:::platZone
     SearchDec:::platZone
     Elastic:::exitNode
     AtlasSearch:::valueNode
     AIUse:::platZone
     AgentMem:::valueNode
     SemCache:::valueNode
     RAG:::valueNode
     StreamCheck:::platZone
     Flink:::exitNode
     ASP:::valueNode
     TimeSeries:::valueNode
     Consolidation:::valueNode
     DeployCheck:::deployZone
     Connectors:::valueNode
     SelfMan:::deployZone
     K8s:::valueNode
     OpsMan:::valueNode
     Secure:::deployZone
     Portability:::deployZone
     Dynamo:::exitNode
     NetCheck:::deployZone
     PrivLink:::valueNode
     Peering:::valueNode
     IPList:::valueNode
     RTOCheck:::deployZone
     MultiCloud:::valueNode
     Standard:::valueNode
     Lifecycle:::deployZone
     Archive:::valueNode
     ObsCheck:::deployZone
     ManualOps:::exitNode
     PerfAdv:::valueNode
     CSFLE:::valueNode
     Final:::startNode

    classDef startNode fill:#333,stroke:#333,stroke-width:2px,color:#fff
    classDef techZone fill:#E3F2FD,stroke:#1565C0,stroke-width:2px,color:#000
    classDef scaleZone fill:#FFF3E0,stroke:#EF6C00,stroke-width:2px,color:#000
    classDef platZone fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px,color:#000
    classDef deployZone fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px,color:#000
    classDef valueNode fill:#4DB33D,stroke:#3FA037,stroke-width:3px,font-weight:bold,color:#000,cursor:pointer
    classDef exitNode fill:#F5F5F5,stroke:#616161,stroke-width:1px,stroke-dasharray: 5 5,color:#666
        </div>
    </div>

    <script>
        // --- CONTENT DATABASE ---
        const nodeData = {
            "ObjMatch": {
                title: "Developer Experience",
                value: "Code-Native Data Access",
                detail: "Work with data as natural JSON objects. Eliminates the 'Object-Relational Impedance Mismatch' and removes the need for complex, brittle ORM layers like Hibernate or Prisma.",
                link: "https://www.mongodb.com/developer/products/mongodb/object-relational-impedance-mismatch/"
            },
            "AgileVal": {
                title: "Business Agility",
                value: "Faster Time-to-Market",
                detail: "Polymorphic schema allows you to launch new features without database downtime or running risky 'ALTER TABLE' migration scripts. The database adapts to your code, not vice versa.",
                link: "https://www.mongodb.com/basics/flexible-schema"
            },
            "Consolidation": {
                title: "Tech Stack Consolidation",
                value: "Lower TCO & Complexity",
                detail: "By combining Transactional, Search, AI, and Time Series workloads into one API, you remove the cost and maintenance burden of syncing 3-4 separate niche databases.",
                link: "https://www.mongodb.com/products/platform"
            },
            "Logical": {
                title: "Logical Sharding",
                value: "Simple Multi-Tenancy",
                detail: "Isolates tenants using a 'tenant_id' field within standard collections. Ideal for high-volume SaaS where tenants share resources but need logical separation.",
                link: "https://www.mongodb.com/resources/products/capabilities/multitenancy"
            },
            "TenantShard": {
                title: "Tenant-Aware Sharding",
                value: "Physical Isolation",
                detail: "Pin specific tenants to specific hardware. Allows you to offer 'Premium Tier' performance on dedicated NVMe nodes while keeping 'Free Tier' users on shared hardware—all in one cluster.",
                link: "https://www.mongodb.com/docs/manual/core/sharded-cluster-partitioning/"
            },
            "MongoCore": {
                title: "MongoDB Core",
                value: "The Intelligent Document Database",
                detail: "The foundation. Stores data in BSON (Binary JSON), supporting rich indexing, ACID transactions, and aggregations. It scales horizontally by default.",
                link: "https://www.mongodb.com/docs/manual/core/document/"
            },
            "Migrator": {
                title: "Relational Migrator",
                value: "Automated Modernization",
                detail: "Analyzes legacy SQL schemas and automatically generates optimized MongoDB document models and code. De-risks the migration process.",
                link: "https://www.mongodb.com/products/relational-migrator"
            },
            "HashShard": {
                title: "Hashed Sharding",
                value: "Perfect Write Distribution",
                detail: "Distributes data based on a hash of the shard key. Ensures writes are spread evenly across all nodes, preventing 'hotspots' during massive ingest events.",
                link: "https://www.mongodb.com/docs/manual/core/hashed-sharding/"
            },
            "ZoneShard": {
                title: "Zone Sharding",
                value: "Data Locality / Sovereignty",
                detail: "Allows you to tag shards by geography (e.g., 'EU-West'). Data for German users stays physically on German servers to comply with GDPR, while US data stays in Virginia.",
                link: "https://www.mongodb.com/docs/manual/core/zone-sharding/"
            },
            "RangeShard": {
                title: "Ranged Sharding",
                value: "Optimized Range Queries",
                detail: "Divides data into continuous ranges (e.g., Time or Alphabetical). Ideal for efficient queries that scan a specific window of time or sequence.",
                link: "https://www.mongodb.com/docs/manual/core/ranged-sharding/"
            },
            "Replica": {
                title: "Replica Set",
                value: "High Availability (HA)",
                detail: "A group of at least 3 nodes that maintain the same data set. Provides automatic failover and data redundancy. If the primary crashes, a secondary takes over in seconds.",
                link: "https://www.mongodb.com/docs/manual/replication/"
            },
            "ASP": {
                title: "Atlas Stream Processing",
                value: "Analyze Data In-Flight",
                detail: "Process high-velocity streams (Kafka/EventHub) continuously before storing them. Use standard MongoDB aggregation syntax to build real-time alerts and views.",
                link: "https://www.mongodb.com/products/capabilities/stream-processing"
            },
            "AtlasSearch": {
                title: "Atlas Search",
                value: "Lucene-Powered Search",
                detail: "Full-text search integrated into the database. Features fuzzy matching, autocomplete, and highlighting without managing a separate Elasticsearch cluster.",
                link: "https://www.mongodb.com/docs/atlas/atlas-search/"
            },
            "Vector": {
                title: "Vector Search",
                value: "Unified Memory for AI",
                detail: "Store and query vector embeddings alongside operational data. Enables semantic search and RAG workflows without an external vector DB.",
                link: "https://www.mongodb.com/products/platform/atlas-vector-search"
            },
            "AgentMem": {
                title: "Agent Memory",
                value: "Long-Term Context",
                detail: "Use MongoDB to store conversation history and context for AI Agents. Vector search retrieves relevant past interactions to make the AI smarter over time.",
                link: "https://www.mongodb.com/developer/products/atlas/building-generative-ai-applications-vector-search/"
            },
            "SemCache": {
                title: "Semantic Cache",
                value: "Reduce LLM Costs",
                detail: "Cache LLM responses based on semantic similarity. If a user asks a question similar to a previous one, serve the cached answer instantly instead of paying for a new GPU call.",
                link: "https://www.mongodb.com/developer/products/atlas/semantic-cache-vector-search/"
            },
            "RAG": {
                title: "RAG (Retrieval Augmented Generation)",
                value: "Ground AI in Truth",
                detail: "Retrieve accurate, private enterprise data from MongoDB and feed it to the LLM to prevent hallucinations and provide domain-specific answers.",
                link: "https://www.mongodb.com/basics/rag"
            },
            "TimeSeries": {
                title: "Time Series Collections",
                value: "IoT Efficiency",
                detail: "Columnar storage optimized for time-series data. significantly reduces storage costs and improves query speed for sensor data and metrics.",
                link: "https://www.mongodb.com/docs/manual/core/timeseries-collections/"
            },
            "Connectors": {
                title: "Ecosystem Connectors",
                value: "Enterprise Integration",
                detail: "Official connectors for Kafka, Spark, Flink, and Databricks. Ensures reliable, high-throughput data pipelines without custom glue code.",
                link: "https://www.mongodb.com/products/tools/connectors"
            },
            "K8s": {
                title: "Enterprise Operator",
                value: "Kubernetes Native",
                detail: "Deploy and manage MongoDB clusters inside your own Kubernetes environment (OpenShift/EKS/AKS). Automates upgrades, scaling, and backups.",
                link: "https://www.mongodb.com/products/tools/kubernetes-operator"
            },
            "OpsMan": {
                title: "Ops Manager",
                value: "On-Prem Automation",
                detail: "The management plane for self-managed deployments. Provides a GUI for deploying, monitoring, and backing up clusters on VMs or Bare Metal.",
                link: "https://www.mongodb.com/docs/ops-manager/current/"
            },
            "PrivLink": {
                title: "PrivateLink",
                value: "Secure Unidirectional Access",
                detail: "The gold standard for cloud security. Allows your VPC to connect to MongoDB Atlas privately without traversing the public internet or exposing ports.",
                link: "https://www.mongodb.com/docs/atlas/security-private-endpoint/"
            },
            "Peering": {
                title: "VPC Peering",
                value: "Bi-Directional Networking",
                detail: "Connects your VPC network directly to the Atlas VPC network. Useful for legacy setups, though PrivateLink is generally preferred for tighter security.",
                link: "https://www.mongodb.com/docs/atlas/security-vpc-peering/"
            },
            "IPList": {
                title: "IP Access List",
                value: "Basic Firewalling",
                detail: "Allow access only from specific IP addresses or CIDR blocks. Simple to set up for development or smaller deployments.",
                link: "https://www.mongodb.com/docs/atlas/security/ip-access-list/"
            },
            "MultiCloud": {
                title: "Multi-Cloud Cluster",
                value: "Ultimate Resilience",
                detail: "Span your cluster across AWS, Azure, and Google Cloud simultaneously. Protects against entire cloud provider outages.",
                link: "https://www.mongodb.com/docs/atlas/configure-cluster-regions/"
            },
            "Standard": {
                title: "Standard Cluster",
                value: "Reliable & Cost-Effective",
                detail: "A standard 3-node replica set deployed in a single region. Provides 99.99% uptime and automatic failover for most production workloads.",
                link: "https://www.mongodb.com/pricing"
            },
            "Archive": {
                title: "Online Archive",
                value: "Cost-Efficient History",
                detail: "Automatically moves old data to cheap S3 object storage while keeping it queryable. Reduces the cost of storing petabytes of historical logs.",
                link: "https://www.mongodb.com/docs/atlas/online-archive/"
            },
            "PerfAdv": {
                title: "Performance Advisor",
                value: "24/7 Intelligent Ops",
                detail: "A built-in tool that analyzes your slow queries and automatically suggests indexes to fix them. It acts as an automated DBA.",
                link: "https://www.mongodb.com/docs/atlas/performance-advisor/"
            },
            "CSFLE": {
                title: "Queryable Encryption",
                value: "Encryption-in-Use",
                detail: "State-of-the-art security. Encrypts data on the client side so the database server never sees the plaintext keys. Allows querying on encrypted data.",
                link: "https://www.mongodb.com/docs/manual/core/queryable-encryption/"
            }
        };

        // --- INTERACTIVITY LOGIC ---
        var panZoomInstance;

        // 1. Initialize Mermaid
        mermaid.initialize({ startOnLoad: true, securityLevel: 'loose' });

        // 2. Define the Click Handler
        window.showInfo = function(nodeId) {
            // Prevent event bubbling so clicking a node doesn't immediately close the drawer via body click
            event.stopPropagation();

            const data = nodeData[nodeId];
            if (data) {
                document.getElementById('drawer-title').innerText = data.title;
                document.getElementById('drawer-value').innerText = data.value;
                document.getElementById('drawer-details').innerText = data.detail;
                
                const linkBtn = document.getElementById('drawer-link');
                if (data.link) {
                    linkBtn.href = data.link;
                    linkBtn.classList.remove('no-link');
                    linkBtn.innerText = "Read Documentation →";
                    linkBtn.style.pointerEvents = "auto";
                } else {
                    linkBtn.classList.add('no-link');
                    linkBtn.innerText = "No Link Available";
                    linkBtn.style.pointerEvents = "none";
                }
                
                // Open Drawer
                document.getElementById('side-drawer').classList.add('open');
            }
        };

        window.closeDrawer = function() {
            document.getElementById('side-drawer').classList.remove('open');
        };

        // 3. Pan-Zoom Setup
        const interval = setInterval(() => {
            const svg = document.querySelector('.mermaid svg');
            if (svg && svg.getBoundingClientRect().height > 10) {
                clearInterval(interval);
                svg.style.height = '100%';
                svg.style.width = '100%';
                svg.style.maxWidth = 'none';

                panZoomInstance = svgPanZoom(svg, {
                    zoomEnabled: true,
                    controlIconsEnabled: false,
                    fit: true,
                    center: true,
                    minZoom: 0.1,
                    maxZoom: 10
                });
                panZoomInstance.resize();
                panZoomInstance.fit();
                panZoomInstance.center();
            }
        }, 100);

        function zoomIn() { if(panZoomInstance) panZoomInstance.zoomIn(); }
        function zoomOut() { if(panZoomInstance) panZoomInstance.zoomOut(); }
        function resetZoom() { if(panZoomInstance) { panZoomInstance.resetZoom(); panZoomInstance.center(); } }
        
        window.addEventListener('resize', function(){
            if(panZoomInstance) { panZoomInstance.resize(); panZoomInstance.fit(); panZoomInstance.center(); }
        });
    </script>
</body>
</html>